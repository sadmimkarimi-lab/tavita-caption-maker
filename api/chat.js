// api/chat.js
// Ù†Ø³Ø®Ù‡â€ŒÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ´Ø¯Ù‡ Ùˆ Ù‡ÙˆØ´Ù…Ù†Ø¯ØªØ±
// ----------------------------------------------------------
// Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ù…Ø³Ø¦ÙˆÙ„:
//  - ØµØ­Ø¨Øª Ø¨Ø§ Ù…Ø¯Ù„ Groq
//  - ÙÛŒÙ„ØªØ± Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù…Ù†ÙˆØ¹ (ÙˆØ±ÙˆØ¯ÛŒ + Ø®Ø±ÙˆØ¬ÛŒ)
//  - Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø¬ÙˆØ§Ø¨ ØªÙ…ÛŒØ² Ø¨Ù‡ ÙØ±Ø§Ù†Øª
// ----------------------------------------------------------

// ØªÙ…ÛŒØ² Ú©Ø±Ø¯Ù† Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´
function cleanAnswer(text) {
  if (!text || typeof text !== "string") {
    return "Ù†ØªÙˆØ§Ù†Ø³ØªÙ… Ù¾Ø§Ø³Ø®ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†Ù….";
  }

  let t = text.trim();

  // Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·â€ŒÙ‡Ø§
  t = t.replace(/\r\n/g, "\n");

  // Ø­Ø¯Ø§Ú©Ø«Ø± Ø¯Ùˆ Ø®Ø· Ø®Ø§Ù„ÛŒ Ù¾Ø´Øª Ø³Ø± Ù‡Ù…
  t = t.replace(/\n{3,}/g, "\n\n");

  // Ø­Ø°Ù ÙØ§ØµÙ„Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡â€ŒÛŒ Ø¢Ø®Ø± Ù‡Ø± Ø®Ø·
  const lines = t.split("\n").map((line) => line.replace(/\s+$/g, ""));
  return lines.join("\n");
}

// Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„ØªØ±Ú©Ø±Ø¯Ù† Ù‡ÙˆØ´Ù…Ù†Ø¯ØªØ±
function normalizeText(text) {
  if (!text) return "";
  return text
    .toString()
    // ÛŒÚ©Ø³Ø§Ù†â€ŒØ³Ø§Ø²ÛŒ ÛŒ Ùˆ Ú© Ø¹Ø±Ø¨ÛŒ/ÙØ§Ø±Ø³ÛŒ
    .replace(/ÙŠ/g, "ÛŒ")
    .replace(/Ù‰/g, "ÛŒ")
    .replace(/Ùƒ/g, "Ú©")
    // Ø­Ø°Ù/ØªØ¨Ø¯ÛŒÙ„ Ù†ÛŒÙ…â€ŒÙØ§ØµÙ„Ù‡ Ø¨Ù‡ ÙØ§ØµÙ„Ù‡ Ø³Ø§Ø¯Ù‡
    .replace(/\u200c/g, " ")
    // Ø­Ø°Ù ÙØ§ØµÙ„Ù‡â€ŒÙ‡Ø§ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ
    .replace(/\s+/g, " ")
    .trim()
    .toLowerCase();
}

// ğŸš« Ù„ÛŒØ³Øª Ú©Ù„Ù…Ø§Øª Ùˆ Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ù…Ù…Ù†ÙˆØ¹ (Ø³Ø®Øªâ€ŒÚ¯ÛŒØ±Ø§Ù†Ù‡ØŒ Ø§Ù…Ø§ Ø¨Ø¯ÙˆÙ† Ú©Ù„Ù…Ø§Øª Ù…Ø¨Ù‡Ù… Ú©ÙˆØªØ§Ù‡)
const BLOCKED_KEYWORDS = [
  // Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø¬Ù†Ø³ÛŒØŒ Ø²Ù†Ø§Ø´ÙˆÛŒÛŒ Ùˆ ØºÛŒØ±Ø§Ø®Ù„Ø§Ù‚ÛŒ
  "Ø³Ú©Ø³",
  "sex",
  "Ø±Ø§Ø¨Ø·Ù‡ Ø¬Ù†Ø³ÛŒ",
  "Ø±Ø§Ø¨Ø·Ù‡ Ù†Ø§Ù…Ø´Ø±ÙˆØ¹",
  "Ù¾ÙˆØ±Ù†",
  "porn",
  "Ù¾ÙˆØ±Ù†Ùˆ",
  "ÙÛŒÙ„Ù… Ù…Ø³ØªÙ‡Ø¬Ù†",
  "Ù…Ø³ØªÙ‡Ø¬Ù†",
  "Ø¨Ø±Ù‡Ù†Ù‡",
  "Ø¨Ø±Ù‡Ù†Ú¯ÛŒ",
  "Ù†ÛŒÙ…Ù‡ Ø¨Ø±Ù‡Ù†Ù‡",
  "Ù‡Ù…Ø®ÙˆØ§Ø¨ÛŒ",
  "Ù‡Ù… Ø®ÙˆØ§Ø¨",
  "Ø²Ù†Ø§Ø´ÙˆÛŒÛŒ",
  "ØªØ­Ø±ÛŒÚ© Ø¬Ù†Ø³ÛŒ",
  "ÙØ§Ù†ØªØ²ÛŒ Ø¬Ù†Ø³ÛŒ",
  "Ø³Ú©Ø³ÛŒ",
  "Ø§Ø±Ø¶Ø§Ø¡",
  "Ø§Ø±Ø¶Ø§",
  "Ø®ÙˆØ¯Ø§Ø±Ø¶Ø§ÛŒÛŒ",
  "Ø®ÙˆØ¯ Ø§Ø±Ø¶Ø§ÛŒÛŒ",
  "Ø±Ø§Ø¨Ø·Ù‡ Ù†Ø§Ù…ØªØ¹Ø§Ø±Ù",
  "Ø´Ù‡ÙˆØª",
  "Ù„Ø¨ Ú¯Ø±ÙØªÙ†",
  "Ø¨ÙˆØ³Ù‡ Ø¬Ù†Ø³ÛŒ",
  "Ø­Ø±ÛŒÙ… Ø®ØµÙˆØµÛŒ Ø²Ù†Ø§Ø´ÙˆÛŒÛŒ",

  // Ù‡Ù…Ø¬Ù†Ø³â€ŒÚ¯Ø±Ø§ÛŒÛŒ Ùˆ Ù…Ø´Ø§Ø¨Ù‡ (Ø¹Ø¨Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ÙˆØ§Ø¶Ø­ØŒ Ù†Ù‡ Ø­Ø±ÙˆÙ Ú©ÙˆØªØ§Ù‡ Ù…Ø¨Ù‡Ù…)
  "Ù‡Ù…Ø¬Ù†Ø³Ú¯Ø±Ø§",
  "Ù‡Ù… Ø¬Ù†Ø³ Ú¯Ø±Ø§",
  "Ù‡Ù…â€ŒØ¬Ù†Ø³â€ŒÚ¯Ø±Ø§",
  "Ù‡Ù…Ø¬Ù†Ø³ Ú¯Ø±Ø§",
  "Ù‡Ù…Ø¬Ù†Ø³ Ø¨Ø§Ø²ÛŒ",
  "Ù‡Ù…Ø¬Ù†Ø³â€ŒØ¨Ø§Ø²ÛŒ",
  "Ù‡Ù…Ø¬Ù†Ø³ Ø¨Ø§Ø²",
  "Ù‡Ù…Ø¬Ù†Ø³â€ŒØ¨Ø§Ø²",
  "Ù‡Ù…Ø¬Ù†Ø³â€ŒØ¨Ø§Ø²Ø§Ù†",
  "ØªØ¬Ù…Ø¹ Ù‡Ù…Ø¬Ù†Ø³",
  "Ø­Ù‚ÙˆÙ‚ Ù‡Ù…Ø¬Ù†Ø³",
  "Ø¯ÙˆØ¬Ù†Ø³Ù‡",
  "Ø¯Ùˆ Ø¬Ù†Ø³Ù‡",
  "Ø¯Ú¯Ø± Ø¨Ø§Ø´",
  "Ø¯Ú¯Ø±Ø¨Ø§Ø´",
  "lgbt",
  "Ù„Ø²Ø¨ÛŒÙ†",
  "lesbian",
  "gay",

  // ÙØ­Ø´Ø§
  "ÙØ­Ø´Ø§",
  "ØªÙ† ÙØ±ÙˆØ´ÛŒ",
  "ØªÙ†â€ŒÙØ±ÙˆØ´ÛŒ",

  // ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ø§Ø¯ÛŒØ§Ù†ØŒ Ù…Ø°Ø§Ù‡Ø¨ Ùˆ Ù…Ù‚Ø¯Ø³Ø§Øª
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ø¯ÛŒÙ†",
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ø§Ø³Ù„Ø§Ù…",
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ø´ÛŒØ¹Ù‡",
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ ØªØ´ÛŒØ¹",
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ù…Ø³Ù„Ù…Ø§Ù†",
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ù‚Ø±Ø¢Ù†",
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ù¾ÛŒØ§Ù…Ø¨Ø±",
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ø§Ù‡Ù„ Ø¨ÛŒØª",
  "Ø¨ÛŒâ€ŒØ¯ÛŒÙ†ÛŒ",
  "Ø¨ÛŒ Ø¯ÛŒÙ†ÛŒ",
  "Ú©ÙØ± Ú¯ÙØªÙ†",
  "Ø§Ù‡Ø§Ù†Øª Ø¨Ù‡ Ù…Ù‚Ø¯Ø³Ø§Øª",
  "Ø§Ù‡Ø§Ù†Øª Ø¨Ù‡ Ø¯ÛŒÙ†",
  "Ø§Ù‡Ø§Ù†Øª Ø¨Ù‡ Ø®Ø¯Ø§",

  // ØªÙˆÙ‡ÛŒÙ† Ø´Ø¯ÛŒØ¯ Ø¨Ù‡ Ø±ÙˆØ­Ø§Ù†ÛŒØª
  "Ø¶Ø¯ Ø¢Ø®ÙˆÙ†Ø¯",
  "Ø¶Ø¯ Ø¢Ø®ÙˆÙ†Ø¯Ù‡Ø§",
  "Ø¢Ø®ÙˆÙ†Ø¯Ù‡Ø§ Ø¨Ø¯",
  "Ù†ÙØ±Øª Ø§Ø² Ø¢Ø®ÙˆÙ†Ø¯",
  "ÙØ­Ø´ Ø¨Ù‡ Ø¢Ø®ÙˆÙ†Ø¯",
  "Ø¢Ø®ÙˆÙ†Ø¯ Ø²Ø§Ø¯Ù‡",
  "Ù…Ø±Ú¯ Ø¨Ø± Ø¢Ø®ÙˆÙ†Ø¯",
  "Ø¢Ø®ÙˆÙ†Ø¯Ù‡Ø§ Ø±Ø§",

  // Ø®Ø´ÙˆÙ†Øª Ø´Ø¯ÛŒØ¯ØŒ Ø¬Ø±Ù… Ùˆ Ø±ÙØªØ§Ø±Ù‡Ø§ÛŒ Ø®Ø·Ø±Ù†Ø§Ú©
  "Ø¢Ù…ÙˆØ²Ø´ Ø®ÙˆØ¯Ú©Ø´ÛŒ",
  "Ù†Ø­ÙˆÙ‡ Ø®ÙˆØ¯Ú©Ø´ÛŒ",
  "Ø®ÙˆØ¯Ú©Ø´ÛŒ",
  "Ú†Ø·ÙˆØ± Ø®ÙˆØ¯Ù… Ø±Ø§ Ø¨Ú©Ø´Ù…",
  "Ú†Ø·ÙˆØ± Ø®ÙˆØ¯Ù…Ùˆ Ø¨Ú©Ø´Ù…",
  "Ø¢Ø³ÛŒØ¨ Ø²Ø¯Ù† Ø¨Ù‡ Ø®ÙˆØ¯",
  "Ø¢Ø³ÛŒØ¨ Ø¨Ù‡ Ø¯ÛŒÚ¯Ø±Ø§Ù†",
  "Ù‚ØªÙ„",
  "Ú†Ø·ÙˆØ± Ú©Ø³ÛŒ Ø±Ø§ Ø¨Ú©Ø´Ù…",
  "Ø³Ø§Ø®Øª Ù…ÙˆØ§Ø¯ Ù…Ø®Ø¯Ø±",
  "Ù¾Ø®Øª Ù…ÙˆØ§Ø¯ Ù…Ø®Ø¯Ø±",
  "Ø®Ø±ÛŒØ¯ Ù…ÙˆØ§Ø¯ Ù…Ø®Ø¯Ø±",
  "ÙØ±ÙˆØ´ Ù…ÙˆØ§Ø¯ Ù…Ø®Ø¯Ø±",
  "Ù…ØµØ±Ù Ù…ÙˆØ§Ø¯ Ù…Ø®Ø¯Ø±",
  "ÙØ±Ø§Ø± Ø§Ø² Ù‚Ø§Ù†ÙˆÙ†",
  "Ø¯ÙˆØ± Ø²Ø¯Ù† Ù‚Ø§Ù†ÙˆÙ†",
  "Ø¢Ø²Ø§Ø± Ú©ÙˆØ¯Ú©",
  "Ú©ÙˆØ¯Ú©â€ŒØ¢Ø²Ø§Ø±ÛŒ",
  "Ú©ÙˆØ¯Ú© Ø¢Ø²Ø§Ø±ÛŒ",
  "Ø³ÙˆØ¡Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¬Ù†Ø³ÛŒ",
  "Ø³ÙˆØ¡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¬Ù†Ø³ÛŒ",
  "ØªØ¬Ø§ÙˆØ² Ø¬Ù†Ø³ÛŒ",
  "ØªÙ‡Ø¯ÛŒØ¯ Ø¬Ø§Ù†ÛŒ",
  "Ø³Ø§Ø®Øª Ø§Ø³Ù„Ø­Ù‡",
  "Ø³Ø§Ø®Øª Ø¨Ù…Ø¨",

  // Ù†ÙØ±Øª Ùˆ ØªÙˆÙ‡ÛŒÙ† Ø´Ø¯ÛŒØ¯ Ø¨Ù‡ Ø§Ù‚ÙˆØ§Ù… Ùˆ Ù…Ù„ÛŒØªâ€ŒÙ‡Ø§
  "Ù†ÙØ±Øª Ø§Ø² Ø¹Ø±Ø¨",
  "Ù†ÙØ±Øª Ø§Ø² ÙØ§Ø±Ø³",
  "Ù†ÙØ±Øª Ø§Ø² ØªØ±Ú©",
  "Ù†ÙØ±Øª Ø§Ø² Ø§ÙØºØ§Ù†",
  "ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ù†Ú˜Ø§Ø¯",
  "Ù†Ú˜Ø§Ø¯Ù¾Ø±Ø³ØªÛŒ",
  "ØªØ­Ù‚ÛŒØ± Ù‚ÙˆÙ…ÛŒØª",

  // Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø³ÛŒØ§Ø³ÛŒ ØªÙ†Ø¯ Ùˆ Ø¨Ø±Ø§Ù†Ø¯Ø§Ø²Ø§Ù†Ù‡
  "Ø¨Ø±Ø§Ù†Ø¯Ø§Ø²ÛŒ",
  "Ø³Ø±Ù†Ú¯ÙˆÙ†ÛŒ",
  "Ø´ÙˆØ±Ø´ Ø®ÛŒØ§Ø¨Ø§Ù†ÛŒ",
  "Ø¢Ø´ÙˆØ¨ Ø®ÛŒØ§Ø¨Ø§Ù†ÛŒ",
  "Ø§Ø¹ØªØµØ§Ø¨ Ø³Ø±Ø§Ø³Ø±ÛŒ",
  "ØªØ­Ø±ÛŒÙ… Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª",
  "Ø§Ø¹ØªØ±Ø§Ø¶ Ø³ÛŒØ§Ø³ÛŒ",
  "Ø§Ø¹ØªØ±Ø§Ø¶ Ø®ÛŒØ§Ø¨Ø§Ù†ÛŒ",
  "Ø§ØºØªØ´Ø§Ø´",
  "Ø¢Ø´ÙˆØ¨",
  "Ø¶Ø¯ Ø¬Ù…Ù‡ÙˆØ±ÛŒ Ø§Ø³Ù„Ø§Ù…ÛŒ",
  "Ø¶Ø¯ Ù†Ø¸Ø§Ù…",
  "Ø¶Ø¯ Ø­Ú©ÙˆÙ…Øª",
  "Ø­Ú©ÙˆÙ…Øª ÙØ¹Ù„ÛŒ Ø¯Ø± Ø®Ø·Ø±",
  "ØªØ¬Ù…Ø¹ Ø¶Ø¯ Ø¬Ù…Ù‡ÙˆØ±ÛŒ",
  "ØªØ¬Ù…Ø¹ Ø¶Ø¯ Ø­Ú©ÙˆÙ…Øª",
  "ØªØ¬Ù…Ø¹ Ø¶Ø¯ Ù†Ø¸Ø§Ù…"
];

// Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø¹Ø¨Ø§Ø±ØªÛŒ Ø­Ø³Ø§Ø³ (Ø¨Ø±Ø§ÛŒ Ú¯Ø±ÙØªÙ† ØªØ±Ú©ÛŒØ¨â€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ + Ú©Ù„Ù…Ø§Øª Ú©ÙˆØªØ§Ù‡ Ù…Ø¨Ù‡Ù… Ù…Ø«Ù„ Â«Ú¯ÛŒÂ» Ø¨Ù‡â€ŒØ¹Ù†ÙˆØ§Ù† Ú©Ù„Ù…Ù‡â€ŒÛŒ Ù…Ø³ØªÙ‚Ù„)
const BLOCKED_PHRASES = [
  // Ù…Ø­ØªÙˆØ§ÛŒ Ø³ÛŒØ§Ø³ÛŒ ØµØ±ÛŒØ­
  /Ú©Ù¾Ø´Ù†\s+Ø³ÛŒØ§Ø³ÛŒ/iu,
  /Ù…ØªÙ†\s+Ø³ÛŒØ§Ø³ÛŒ/iu,
  /Ù…Ø­ØªÙˆØ§\s+Ø³ÛŒØ§Ø³ÛŒ/iu,
  /Ø¶Ø¯\s+(Ù†Ø¸Ø§Ù…|Ø­Ú©ÙˆÙ…Øª|Ø¬Ù…Ù‡ÙˆØ±ÛŒ\s+Ø§Ø³Ù„Ø§Ù…ÛŒ|Ø¢Ø®ÙˆÙ†Ø¯)/iu,
  /(Ú©Ù¾Ø´Ù†|Ù…ØªÙ†|Ù¾Ø³Øª).*(Ø¶Ø¯|Ø§Ù†ØªÙ‚Ø§Ø¯).*(Ø¬Ù…Ù‡ÙˆØ±ÛŒ\s+Ø§Ø³Ù„Ø§Ù…ÛŒ|Ù†Ø¸Ø§Ù…|Ø­Ú©ÙˆÙ…Øª|Ø¢Ø®ÙˆÙ†Ø¯)/iu,

  // Ù‡Ù…Ø¬Ù†Ø³â€ŒÚ¯Ø±Ø§ÛŒÛŒ / lgbt
  /ØªØ¬Ù…Ø¹\s+(Ù‡Ù…Ø¬Ù†Ø³|Ø¯Ùˆ\s*Ø¬Ù†Ø³|Ø¯ÙˆØ¬Ù†Ø³Ù‡|Ù‡Ù…Ø¬Ù†Ø³â€ŒØ¨Ø§Ø²)/iu,
  /Ø­Ù‚ÙˆÙ‚\s+Ø§Ù„?Ø¬ÛŒ?Ø¨ÛŒ?ØªÛŒ/iu,

  // Â«Ú¯ÛŒÂ» Ø¨Ù‡â€ŒØ¹Ù†ÙˆØ§Ù† Ú©Ù„Ù…Ù‡ Ù…Ø³ØªÙ‚Ù„ (Ù†Ù‡ ÙˆØ³Ø· Ú©Ù„Ù…Ø§Øª Ø¯ÛŒÚ¯Ø±)
  /(^|\s)Ú¯ÛŒ(\s|[.!ØŸ?,ØŒ:;â€¦]|$)/iu
];

// ğŸ§© ØªØ§Ø¨Ø¹ ØªØ´Ø®ÛŒØµ Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù…Ù†ÙˆØ¹ (Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ Ùˆ Ø®Ø±ÙˆØ¬ÛŒ)
function isBlockedText(rawText) {
  if (!rawText) return false;

  const normalized = normalizeText(rawText);

  if (!normalized) return false;

  // Û±) Ø¬Ø³Øªâ€ŒÙˆØ¬ÙˆÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø¹Ø¨Ø§Ø±ØªÛŒ (Regex)
  for (const pattern of BLOCKED_PHRASES) {
    if (pattern.test(normalized)) {
      console.warn("Blocked by phrase:", pattern);
      return true;
    }
  }

  // Û²) Ø¬Ø³Øªâ€ŒÙˆØ¬ÙˆÛŒ Ú©Ù„ÛŒØ¯ÙˆØ§Ú˜Ù‡â€ŒÙ‡Ø§ (Ø¨Ù‡â€ŒØµÙˆØ±Øª substring Ø±ÙˆÛŒ Ù…ØªÙ† Ù†Ø±Ù…Ø§Ù„â€ŒØ´Ø¯Ù‡)
  for (const kw of BLOCKED_KEYWORDS) {
    if (!kw) continue;
    const normKw = normalizeText(kw);
    if (!normKw) continue;

    if (normalized.includes(normKw)) {
      console.warn("Blocked by keyword:", kw);
      return true;
    }
  }

  return false;
}

// Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Groq Ø¨Ø±Ø§ÛŒ fallback (ÙÙ‚Ø· Ø¯Ùˆ Ù…Ø¯Ù„ Ù…Ø·Ù…Ø¦Ù†)
const GROQ_MODELS = [
  "llama-3.3-70b-versatile", // Ø§ØµÙ„ÛŒ Ùˆ Ù‚ÙˆÛŒ
  "llama-3.1-8b-instant"     // Ø³Ø±ÛŒØ¹ Ùˆ Ø³Ø¨Ú©â€ŒØªØ±
];

// Ø³ÛŒØ³ØªÙ…â€ŒÙ¾Ø±Ø§Ù…Ù¾Øª ÙÙˆÙ„â€ŒØ­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ù¾Ø´Ù†ØŒ ØªÛŒØªØ± Ùˆ Ù¾Ø±Ø§Ù…Ù¾Øª Ø·Ø±Ø§Ø­ÛŒ
const SYSTEM_PROMPT = `
ØªÙˆ Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ ÙØ§Ø±Ø³ÛŒâ€ŒØ²Ø¨Ø§Ù† Â«Ø·Ø§ÙˆÛŒØªØ§Â» Ù‡Ø³ØªÛŒ Ùˆ Ù†Ù‚Ø´ ØªÙˆ Ú©Ù…Ú© Ø¨Ù‡ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ø¨Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø¬ØªÙ…Ø§Ø¹ÛŒ Ø§Ø³Øª.

Ø³Ù‡ Ú©Ø§Ø± Ø§ØµÙ„ÛŒ Ú©Ù‡ Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Ø§Ø² ØªÙˆ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù†Ø¯:

Û±) Ù†ÙˆØ´ØªÙ† Â«Ú©Ù¾Ø´Ù† Ú©Ø§Ù…Ù„ Ùˆ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ù†ØªØ´Ø§Ø±Â» Ø¨Ø±Ø§ÛŒ Ù¾Ø³Øª
   - Ø§Ø² Ø§ÛŒÙ† Ø§Ù„Ú¯Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù† (Ø¨Ø¯ÙˆÙ† Ø§ÛŒÙ† Ú©Ù‡ Ø®ÙˆØ¯Øª Ù‚Ø§Ù„Ø¨ Ø±Ø§ ØªÙˆØ¶ÛŒØ­ Ø¨Ø¯Ù‡ÛŒØŒ ÙÙ‚Ø· Ù…ØªÙ† Ù†Ù‡Ø§ÛŒÛŒ Ø±Ø§ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†):

   *Ú©Ù¾Ø´Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ â€” Ù†Ø³Ø®Ù‡â€ŒÛŒ ÙÙˆÙ„:*
   - Ø®Ø· Ø§ÙˆÙ„: ÛŒÚ© Ù‡ÙˆÚ© Ø®ÙÙ†ØŒ Ú©ÙˆØªØ§Ù‡ØŒ Ø¶Ø±Ø¨Ù‡â€ŒØ§ÛŒ Ùˆ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø§Ø³Ú©Ø±ÙˆÙ„â€ŒØ§Ø³ØªØ§Ù¾Ø± Ø¨Ù†ÙˆÛŒØ³ Ú©Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ù…Ø¬Ø¨ÙˆØ± Ú©Ù†Ø¯ Ø§Ø¯Ø§Ù…Ù‡ Ø±Ø§ Ø¨Ø®ÙˆØ§Ù†Ø¯.
   - Ø¨Ø¯Ù†Ù‡: Ø¯Ø± Û² ØªØ§ Û´ Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ù Ú©ÙˆØªØ§Ù‡ØŒ Ù…ÙˆØ¶ÙˆØ¹ Ø±Ø§ Ø³Ø§Ø¯Ù‡ØŒ Ø§Ù†Ø³Ø§Ù†ÛŒ Ùˆ ÙˆØ§Ù‚Ø¹ÛŒ ØªÙˆØ¶ÛŒØ­ Ø¨Ø¯Ù‡. Ø§Ø² Ø¯Ø§Ø³ØªØ§Ù†â€ŒÚ¯ÙˆÛŒÛŒØŒ Ø³Ø¤Ø§Ù„ØŒ ØªØ¶Ø§Ø¯ØŒ Ù…Ø«Ø§Ù„ ÙˆØ§Ù‚Ø¹ÛŒ Ùˆ ØªØ¬Ø±Ø¨Ù‡â€ŒÛŒ Ù…Ù„Ù…ÙˆØ³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†.
   - Ù…ØªÙ† Ø¨Ø§ÛŒØ¯ Ø·Ø¨ÛŒØ¹ÛŒØŒ Ø®ÙˆØ´â€ŒØ®ÙˆØ§Ù†ØŒ ØµÙ…ÛŒÙ…ÛŒ Ùˆ Ø´Ø¨ÛŒÙ‡ ÛŒÚ© Ø¢Ø¯Ù… Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø§Ø´Ø¯Ø› Ù†Ù‡ Ø´Ø¨ÛŒÙ‡ Ø±Ø¨Ø§Øª.
   - Ø¨Ø±Ø§Ø³Ø§Ø³ Ù‡Ø¯Ù Ú©Ù¾Ø´Ù† (ØªØ¹Ø§Ù…Ù„ØŒ ÙØ±ÙˆØ´ØŒ Ø°Ø®ÛŒØ±Ù‡ØŒ Ø¢Ú¯Ø§Ù‡ÛŒâ€ŒØ±Ø³Ø§Ù†ÛŒ Ùˆ...) ÛŒÚ© CTA Ú©Ø§Ù…Ù„Ø§Ù‹ ÙˆØ§Ø¶Ø­ Ùˆ Ù‚Ø§Ø¨Ù„ Ø§Ø¬Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³
     (Ù…Ø«Ù„Ø§Ù‹: Â«Ù†Ø¸Ø±Øª Ø±Ùˆ Ø¨Ø±Ø§Ù… Ø¨Ù†ÙˆÛŒØ³Â»ØŒ Â«Ø§ÛŒÙ† Ù¾Ø³Øª Ø±Ùˆ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ¯Øª Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†Â»ØŒ Â«Ø¨Ø±Ø§Ù… Ù¾ÛŒØ§Ù… Ø¨Ø¯Ù‡ ØªØ§ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒØª Ú©Ù†Ù…Â» Ùˆâ€¦).
   - Ø§Ú¯Ø± Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù… / Ø§ÛŒØªØ§Ø³ØªØŒ Ø¯Ø± Ø§Ù†ØªÙ‡Ø§ ÛŒÚ© Ø¨Ù„ÙˆÚ© Ù‡Ø´ØªÚ¯ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ùˆ Ù…Ø±ØªØ¨Ø· Ø¨Ù†ÙˆÛŒØ³ (Ø­Ø¯ÙˆØ¯ Ûµ ØªØ§ Û±Û² Ù‡Ø´ØªÚ¯ØŒ Ù†Ù‡ Ø§Ø³Ù¾Ù… Ùˆ Ø¨ÛŒâ€ŒØ±Ø¨Ø·).

Û²) Ø³Ø§Ø®Øª Â«ØªÛŒØªØ± Ùˆ Ù‡ÙˆÚ©â€ŒÙ‡Ø§ÛŒ Ú©ÙˆØªØ§Ù‡ Ùˆ Ø®ÙÙ†Â» Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ú©Ù¾Ø´Ù† ÛŒØ§ Ø±ÙˆÛŒ Ú©Ø§ÙˆØ±
   - Ø¯Ø± Ø§ÛŒÙ† Ø­Ø§Ù„Øª Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø±Ø¨Ø§Ø±Ù‡ Â«ØªÛŒØªØ±Â» ÛŒØ§ Â«Ù‡ÙˆÚ©Â» Ù…ÛŒâ€ŒÙ¾Ø±Ø³Ø¯.
   - Ù‚Ø§Ù†ÙˆÙ†:
     - Ø­Ø¯Ø§Ù‚Ù„ Û±Û° Ùˆ Ø­Ø¯Ø§Ú©Ø«Ø± Û±Û´ ØªÛŒØªØ±/Ù‡ÙˆÚ© Ú©ÙˆØªØ§Ù‡ Ø¨Ù†ÙˆÛŒØ³.
     - Ù‡Ø± ØªÛŒØªØ± ÙÙ‚Ø· Ø¯Ø± ÛŒÚ© Ø®Ø· Ø¨Ø§Ø´Ø¯.
     - Ø§Ø² ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ Ú©Ù†Ø¬Ú©Ø§ÙˆÛŒØŒ ØªØ¶Ø§Ø¯ØŒ Ø³Ø¤Ø§Ù„ØŒ FOMOØŒ Ø´ÙˆÚ©ØŒ Ú†Ø§Ù„Ø´ØŒ ØªØ¬Ø±Ø¨Ù‡â€ŒÛŒ ÙˆØ§Ù‚Ø¹ÛŒ Ùˆ ØªØºÛŒÛŒØ± Ø²Ø§ÙˆÛŒÙ‡ Ø¯ÛŒØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†.
     - ØªÛŒØªØ±Ù‡Ø§ Ø¨Ø§ÛŒØ¯ Ù…Ù†Ø§Ø³Ø¨ Ú©Ø§ÙˆØ± Ø±ÛŒÙ„Ø² Ùˆ Ø´Ø±ÙˆØ¹ Ú©Ù¾Ø´Ù† Ø¨Ø§Ø´Ù†Ø¯Ø› ÛŒØ¹Ù†ÛŒ Ú©ÙˆØªØ§Ù‡ØŒ ØªÛŒØ²ØŒ Ù‚Ø§Ø¨Ù„ ÙÙ‡Ù… Ùˆ Ø¨Ø¯ÙˆÙ† Ú©Ù„ÛŒâ€ŒÚ¯ÙˆÛŒÛŒ.
     - Ø®Ø±ÙˆØ¬ÛŒ Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù„ÛŒØ³Øª Ø´Ù…Ø§Ø±Ù‡â€ŒØ¯Ø§Ø± Ø¨Ù†ÙˆÛŒØ³ (Û±. â€¦ Û². â€¦ Û³. â€¦).

Û³) Ù†ÙˆØ´ØªÙ† Â«Ù¾Ø±Ø§Ù…Ù¾Øª Ø·Ø±Ø§Ø­ÛŒ Ú©Ø§ÙˆØ±/Ø¨Ù†Ø±Â» Ø¨Ø±Ø§ÛŒ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ùˆ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
   - Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ù…ÙˆØ±Ø¯ Ø·Ø±Ø§Ø­ÛŒØŒ Ú©Ø§ÙˆØ±ØŒ Ø¨Ù†Ø±ØŒ Ø±ÛŒÙ„Ø²ØŒ Ø§Ø³ØªÙˆØ±ÛŒØŒ ÛŒØ§ Ù¾Ø±Ø§Ù…Ù¾Øª Ø¨Ø±Ø§ÛŒ Midjourney / DALLÂ·E / Leonardo Ø³ÙˆØ§Ù„ Ú©Ø±Ø¯:
     - Ø§Ø¨ØªØ¯Ø§ Ø¯Ø± Û±â€“Û² Ø¬Ù…Ù„Ù‡ØŒ Ù…ÙˆØ¶ÙˆØ¹ Ùˆ Ù¾ÛŒØ§Ù… Ø§ØµÙ„ÛŒ ØªØµÙˆÛŒØ± Ø±Ø§ Ø´ÙØ§Ù ØªÙˆØ¶ÛŒØ­ Ø¨Ø¯Ù‡.
     - Ø³Ù¾Ø³ ØªØ±Ú©ÛŒØ¨â€ŒØ¨Ù†Ø¯ÛŒ ØªØµÙˆÛŒØ± Ø±Ø§ ØªÙˆØµÛŒÙ Ú©Ù†:
       - Ø¹Ù†ØµØ± Ø§ØµÙ„ÛŒ Ú©Ø¬Ø§ÛŒ ØªØµÙˆÛŒØ± Ø¨Ø§Ø´Ø¯ (Ù…Ø±Ú©Ø²ØŒ Ø³Ù…Øª Ø±Ø§Ø³Øª/Ú†Ù¾ØŒ Ø¨Ø§Ù„Ø§/Ù¾Ø§ÛŒÛŒÙ†â€¦).
       - Ù†ÙˆØ¹ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡: Ø³Ø§Ø¯Ù‡ØŒ Ú¯Ø±Ø§Ø¯ÛŒØ§Ù†ØŒ ÙˆØ§Ù‚Ø¹ÛŒØŒ Ø§Ø³ØªÙˆØ¯ÛŒÙˆÛŒÛŒØŒ Ø¨Ø§ÙØªâ€ŒØ¯Ø§Ø±ØŒ Ù…Ø­ÛŒØ· ÙØ±ÙˆØ´Ú¯Ø§Ù‡ØŒ Ø¯ÙØªØ± Ú©Ø§Ø± Ùˆâ€¦
       - Ø§Ú¯Ø± Ù‚Ø±Ø§Ø± Ø§Ø³Øª Ù…ØªÙ† Ø±ÙˆÛŒ ØªØµÙˆÛŒØ± Ø¨Ø§Ø´Ø¯ØŒ ÙÙ‚Ø· Ø¬Ø§ÛŒ ØªÙ‚Ø±ÛŒØ¨ÛŒ Ø¢Ù† Ø±Ø§ Ø¨Ú¯Ùˆ (Ù…Ø«Ù„Ø§Ù‹: Â«ÙØ¶Ø§ÛŒ Ø®Ø§Ù„ÛŒ Ø¨Ø±Ø§ÛŒ ØªÛŒØªØ± Ø¯Ø± Ø¨Ø§Ù„Ø§ÛŒ ØªØµÙˆÛŒØ±Â»ØŒ Ø¨Ø¯ÙˆÙ† Ù†ÙˆØ´ØªÙ† Ø®ÙˆØ¯ Ù…ØªÙ†).
     - Ø±Ù†Ú¯â€ŒÙ‡Ø§ØŒ Ø³Ø¨Ú© Ùˆ ÙØ¶Ø§ÛŒ Ø§Ø­Ø³Ø§Ø³ÛŒ Ø±Ø§ Ø¯Ù‚ÛŒÙ‚ ØªÙˆØµÛŒÙ Ú©Ù†:
       - Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ú¯Ø±Ù…/Ø³Ø±Ø¯ØŒ Ù†Ø¦ÙˆÙ†ÛŒØŒ Ù¾Ø§Ø³ØªÙ„ÛŒØŒ Ø®Ù†Ø«ÛŒ Ùˆâ€¦
       - Ø­Ø³: Ø¯ÙˆØ³ØªØ§Ù†Ù‡ØŒ Ø±Ø³Ù…ÛŒØŒ Ù„ÙˆÚ©Ø³ØŒ ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒÚ©ØŒ Ø¢Ù…ÙˆØ²Ø´ÛŒØŒ Ù‡ÛŒØ¬Ø§Ù†â€ŒØ§Ù†Ú¯ÛŒØ² Ùˆâ€¦
     - Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¬Ø²Ø¦ÛŒØ§Øª Ø®Ø§Øµ Ø¯Ø§Ø¯Ù‡ (Ù…Ø«Ù„ Ø­Ø¶ÙˆØ± Ù„ÙˆÚ¯ÙˆØŒ Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„ØŒ Ø§Ø¨Ø²Ø§Ø±ØŒ Ø¯Ø³ØªÙ ÛŒÚ© ØªØ¹Ù…ÛŒØ±Ú©Ø§Ø± Ùˆâ€¦) Ø­ØªÙ…Ø§Ù‹ Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡â€ŒØ¹Ù†ÙˆØ§Ù† Ø§Ø¬Ø²Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø°Ú©Ø± Ú©Ù†.
     - Ø¯Ø± ÛŒÚ© Ø¬Ù…Ù„Ù‡â€ŒÛŒ Ø¢Ø®Ø± Ù†Ø³Ø¨Øª ØªØµÙˆÛŒØ± Ø±Ø§ Ù…Ø´Ø®Øµ Ú©Ù† (Ù…Ø«Ù„: Â«Ù…Ù†Ø§Ø³Ø¨ Ú©Ø§ÙˆØ± Ù¾Ø³Øª Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù… Ù…Ø±Ø¨Ø¹ Û±:Û±Â» ÛŒØ§ Â«Ú©Ø§ÙˆØ± Ø±ÛŒÙ„Ø²/Ø§Ø³ØªÙˆØ±ÛŒ Ø¹Ù…ÙˆØ¯ÛŒ Û¹:Û±Û¶Â»).

Ù‚ÙˆØ§Ù†ÛŒÙ† Ú©Ù„ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§:
- ÙÙ‚Ø· Ù‡Ù…Ø§Ù† Ú†ÛŒØ²ÛŒ Ø±Ø§ ØªÙˆÙ„ÛŒØ¯ Ú©Ù† Ú©Ù‡ Ø§Ø² ØªÙˆ Ø®ÙˆØ§Ø³ØªÙ‡ Ø´Ø¯Ù‡: Ø§Ú¯Ø± Ú©Ù¾Ø´Ù† Ø®ÙˆØ§Ø³ØªØŒ Ú©Ù¾Ø´Ù† Ú©Ø§Ù…Ù„Ø› Ø§Ú¯Ø± ØªÛŒØªØ± Ø®ÙˆØ§Ø³ØªØŒ ÙÙ‚Ø· ØªÛŒØªØ±Ù‡Ø§Ø› Ø§Ú¯Ø± Ù¾Ø±Ø§Ù…Ù¾Øª Ø·Ø±Ø§Ø­ÛŒ Ø®ÙˆØ§Ø³ØªØŒ ÙÙ‚Ø· ØªÙˆØ¶ÛŒØ­ Ø·Ø±Ø§Ø­ÛŒ.
- Ø²Ø¨Ø§Ù† Ù¾ÛŒØ´â€ŒÙØ±Ø¶ ÙØ§Ø±Ø³ÛŒ Ø±ÙˆØ§Ù† Ùˆ Ø·Ø¨ÛŒØ¹ÛŒ Ø§Ø³ØªØŒ Ù…Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± ØµØ±Ø§Ø­ØªØ§Ù‹ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ø¨Ø®ÙˆØ§Ù‡Ø¯ (Ù…Ø«Ù„Ø§Ù‹ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø§Ù…Ù¾Øª Midjourney).
- Ø§Ø² ØªÙˆØ¶ÛŒØ­ Ù…ØªØ§ (Ù…Ø«Ù„: Â«Ø¯Ø± Ø§Ø¯Ø§Ù…Ù‡ Ú©Ù¾Ø´Ù† Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒÂ» ÛŒØ§ Â«Ø§ÛŒÙ† Ù¾Ø±Ø§Ù…Ù¾Øª Ø§Ø³ØªÂ») Ø®ÙˆØ¯Ø¯Ø§Ø±ÛŒ Ú©Ù†Ø› Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ø§ÛŒØ¯ Ø¢Ù…Ø§Ø¯Ù‡â€ŒÛŒ Ú©Ù¾ÛŒâ€ŒÙ¾ÛŒØ³Øª Ø¨Ø§Ø´Ø¯.
- Ø§Ø² Ø¬Ù…Ù„Ø§Øª ØªÚ©Ø±Ø§Ø±ÛŒ Ùˆ Ú©Ù„ÛŒØ´Ù‡â€ŒØ§ÛŒ Ø²ÛŒØ§Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†Ø› Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø³Ø¹ÛŒ Ú©Ù† Ú©Ù…ÛŒ Ø®Ù„Ø§Ù‚ÛŒØª Ùˆ Ø²Ø§ÙˆÛŒÙ‡â€ŒÛŒ Ø¯ÛŒØ¯ Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒ.
- Ù„Ø­Ù† Ùˆ Ù…ÛŒØ²Ø§Ù† Ø±Ø³Ù…ÛŒâ€ŒØ¨ÙˆØ¯Ù† Ø±Ø§ Ø§Ø² Ù„Ø­Ù† Ø®ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ùˆ Ú©Ù„Ù…Ø§ØªÛŒ Ú©Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø±Ø¯Ù‡ Ù…ØªÙˆØ¬Ù‡ Ø´Ùˆ Ùˆ Ù…Ø·Ø§Ø¨Ù‚ Ù‡Ù…Ø§Ù† Ø¨Ù†ÙˆÛŒØ³.

Ù‚ÙˆØ§Ù†ÛŒÙ† Ø§Ø®Ù„Ø§Ù‚ÛŒØŒ Ø¯ÛŒÙ†ÛŒØŒ Ø§ÛŒØ±Ø§Ù†ÛŒ Ùˆ Ø§Ù†Ø³Ø§Ù†ÛŒ (Ø®ÛŒÙ„ÛŒ Ù…Ù‡Ù…):
- Ø§Ø² Ù†ÙˆØ´ØªÙ† Ù‡Ø±Ú¯ÙˆÙ†Ù‡ Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ø®Ø§Ù„Ù Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§ÛŒ Ø§Ø³Ù„Ø§Ù…ÛŒØŒ Ù…Ø°Ù‡Ø¨ ØªØ´ÛŒØ¹ Ùˆ Ù‚ÙˆØ§Ù†ÛŒÙ† Ø¬Ù…Ù‡ÙˆØ±ÛŒ Ø§Ø³Ù„Ø§Ù…ÛŒ Ø®ÙˆØ¯Ø¯Ø§Ø±ÛŒ Ú©Ù†.
- Ù‡ÛŒÚ†â€ŒÚ¯ÙˆÙ†Ù‡ ØªÙˆÙ‡ÛŒÙ†ØŒ Ø¨ÛŒâ€ŒØ§Ø­ØªØ±Ø§Ù…ÛŒØŒ ØªÙ…Ø³Ø®Ø± ÛŒØ§ Ø§Ø¸Ù‡Ø§Ø± Ù†Ø¸Ø± Ù…Ù†ÙÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡Ù”
  Ø§Ø¯ÛŒØ§Ù†ØŒ Ù…Ø°Ø§Ù‡Ø¨ØŒ Ø§Ù‚ÙˆØ§Ù…ØŒ Ù…Ù„ÛŒØªâ€ŒÙ‡Ø§ØŒ Ø¢ÛŒÛŒÙ†â€ŒÙ‡Ø§ Ùˆ Ø¨Ø§ÙˆØ±Ù‡Ø§ÛŒ Ù…Ø¹Ù†ÙˆÛŒ Ø§Ù†Ø¬Ø§Ù… Ù†Ø¯Ù‡.
- Ø¯Ø± Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø²Ù†Ø§Ø´ÙˆÛŒÛŒØŒ Ø¬Ù†Ø³ÛŒØŒ Ø±ÙˆØ§Ø¨Ø· Ù†Ø§Ù…ØªØ¹Ø§Ø±ÙØŒ Ø§Ù„ÙØ§Ø¸ Ø±Ú©ÛŒÚ© ÛŒØ§
  Ù…Ø­ØªÙˆØ§Ù‡Ø§ÛŒ ØªØ­Ø±ÛŒÚ©â€ŒØ¢Ù…ÛŒØ²:
  - ÙˆØ§Ø±Ø¯ ØªÙˆØ¶ÛŒØ­ Ù†Ø´Ùˆ
  - Ø¢Ù…ÙˆØ²Ø´ Ùˆ Ø±Ø§Ù‡Ú©Ø§Ø± Ù†Ø¯Ù‡
  - Ø¯Ø± Ø¬Ø²Ø¦ÛŒØ§Øª Ù†Ø±Ùˆ
  - ÙÙ‚Ø· Ù…Ø­ØªØ±Ù…Ø§Ù†Ù‡ Ø¨Ú¯Ùˆ: Â«Ø¯Ø± Ø§ÛŒÙ† Ø²Ù…ÛŒÙ†Ù‡ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… ØµØ­Ø¨Øª Ú©Ù†Ù….Â»
- Ø¯Ø± Ø­ÙˆØ²Ù‡ Ø³ÛŒØ§Ø³Øª Ùˆ Ù…Ø³Ø§Ø¦Ù„ Ø§Ø¬ØªÙ…Ø§Ø¹ÛŒÙ Ø­Ø³Ø§Ø³:

  - Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ù…Ø­ØªÙˆØ§ÛŒ Â«Ù…Ø«Ø¨ØªØŒ Ù…Ø­ØªØ±Ù…Ø§Ù†Ù‡ Ùˆ Ù‡Ù…Ø³Ùˆ Ø¨Ø§ Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¯Ù… Ùˆ Ú©Ø´ÙˆØ± Ø§ÛŒØ±Ø§Ù†Â» Ø¨Ø®ÙˆØ§Ù‡Ø¯
    (Ù…Ø§Ù†Ù†Ø¯: Û²Û² Ø¨Ù‡Ù…Ù†ØŒ Ø§Ù†Ù‚Ù„Ø§Ø¨ Ø§Ø³Ù„Ø§Ù…ÛŒØŒ Ø¯Ù‡Ù‡ ÙØ¬Ø±ØŒ Ø¯ÙØ§Ø¹ Ù…Ù‚Ø¯Ø³ØŒ Ø´Ù‡Ø¯Ø§ØŒ Ø§ÛŒØ«Ø§Ø±Ú¯Ø±Ø§Ù†ØŒ Ù¾ÛŒØ´Ø±ÙØªâ€ŒÙ‡Ø§ÛŒ Ø¹Ù„Ù…ÛŒ Ùˆ ØµÙ†Ø¹ØªÛŒ Ú©Ø´ÙˆØ±ØŒ
    ÙˆØ­Ø¯Øª Ù…Ù„ÛŒØŒ Ø§Ù…ÛŒØ¯ Ø¨Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡ØŒ Ø®ÙˆØ¯Ú©ÙØ§ÛŒÛŒØŒ Ù¾ÛŒØ´Ø±ÙØª Ø§ÛŒØ±Ø§Ù† Ùˆ Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ù…Ø´Ø§Ø¨Ù‡)ØŒ
    Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒ Ø¨Ø§ Ù„Ø­Ù† Ø¢Ø±Ø§Ù…ØŒ Ù…Ø­ØªØ±Ù…Ø§Ù†Ù‡ Ùˆ Ø§Ù†Ú¯ÛŒØ²Ø´ÛŒ Ú©Ù¾Ø´Ù† ÛŒØ§ Ù…ØªÙ† Ø¢Ù…ÙˆØ²Ø´ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒ.

  - Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡â€ŒØ·ÙˆØ± Ù…Ø³ØªÙ‚ÛŒÙ… ÛŒØ§ ØºÛŒØ±Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ø®ÙˆØ§Ù‡Ø¯:
    * Ù…Ø­ØªÙˆØ§ÛŒ Â«Ø¶Ø¯Ù‘ Ù†Ø¸Ø§Ù…Â»ØŒ Â«Ø¶Ø¯Ù‘ Ø¬Ù…Ù‡ÙˆØ±ÛŒ Ø§Ø³Ù„Ø§Ù…ÛŒÂ»ØŒ Â«Ø¶Ø¯Ù‘ Ø§Ù†Ù‚Ù„Ø§Ø¨Â»ØŒ
      Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ø±Ø§Ù†Ø¯Ø§Ø²ÛŒØŒ ØªØ¬Ù…Ø¹ ÛŒØ§ Ø¢Ø´ÙˆØ¨ Ø®ÛŒØ§Ø¨Ø§Ù†ÛŒØŒ Ø®Ø´ÙˆÙ†Øª Ø³ÛŒØ§Ø³ÛŒØŒ
      ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ø§Ø±Ú©Ø§Ù† Ø­Ø§Ú©Ù…ÛŒØªØŒ Ø¯ÛŒÙ† ÛŒØ§ Ù…Ù‚Ø¯Ø³Ø§ØªØŒ ÛŒØ§ Ù‡Ø± Ù†ÙˆØ¹ Ù…ØªÙ† ØªÙ†Ø¯ Ùˆ ØªØ®Ø±ÛŒØ¨ÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØŒ
    Ø¯Ø± Ø§ÛŒÙ† ØµÙˆØ±Øª:
      ÙÙ‚Ø· Ùˆ ÙÙ‚Ø· Ù‡Ù…ÛŒÙ† Ø¬Ù…Ù„Ù‡â€ŒÛŒ Ú©ÙˆØªØ§Ù‡ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³:
      Â«Ø¯Ø± Ø§ÛŒÙ† Ø²Ù…ÛŒÙ†Ù‡ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ù…Ø­ØªÙˆØ§ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†Ù….Â»

  - Ø­ØªÛŒ Ù‡Ù†Ú¯Ø§Ù… Ù†ÙˆØ´ØªÙ† Ù…ØªÙ†â€ŒÙ‡Ø§ÛŒ Ù…Ø«Ø¨Øª Ùˆ Ø§Ø±Ø²Ø´ÛŒ Ù‡Ù…:
    Ø§Ø² ØªÙˆÙ‡ÛŒÙ†ØŒ Ù…Ø³Ø®Ø±Ù‡â€ŒÚ©Ø±Ø¯Ù†ØŒ Ø¨Ø±Ú†Ø³Ø¨ Ø²Ø¯Ù† Ùˆ Ù†ÙØ±Øªâ€ŒÙ¾Ø±Ø§Ú©Ù†ÛŒ Ø¹Ù„ÛŒÙ‡ Ø§ÙØ±Ø§Ø¯ ÛŒØ§ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ Ø®ÙˆØ¯Ø¯Ø§Ø±ÛŒ Ú©Ù†.
    ØªÙ…Ø±Ú©Ø²Øª Ø±ÙˆÛŒ Â«Ø¢Ú¯Ø§Ù‡ÛŒØŒ Ø§Ù…ÛŒØ¯ØŒ ÙˆØ­Ø¯ØªØŒ Ù¾ÛŒØ´Ø±ÙØª Ùˆ Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø³Ø§Ù†ÛŒ Ùˆ Ø¯ÛŒÙ†ÛŒÂ» Ø¨Ø§Ø´Ø¯.
- Ø§Ø² ØªØ´ÙˆÛŒÙ‚ØŒ Ø¢Ù…ÙˆØ²Ø´ ÛŒØ§ ØªÙˆØ¬ÛŒÙ‡ Ù‡Ø±Ú¯ÙˆÙ†Ù‡ Ø±ÙØªØ§Ø± Ø®Ù„Ø§Ù Ø§Ø®Ù„Ø§Ù‚ØŒ Ø®Ø´ÙˆÙ†Øªâ€ŒØ¢Ù…ÛŒØ²ØŒ
  Ù…Ø¬Ø±Ù…Ø§Ù†Ù‡ØŒ Ø®Ù„Ø§Ù Ù‚Ø§Ù†ÙˆÙ†ØŒ Ø®ÙˆØ¯Ø¢Ø²Ø§Ø±ÛŒØŒ Ù…ØµØ±Ù Ù…ÙˆØ§Ø¯ØŒ ÙØ±ÛŒØ¨ØŒ ØªÙ‡Ø¯ÛŒØ¯ ÛŒØ§ Ù‚Ø§Ù†ÙˆÙ†â€ŒÚ¯Ø±ÛŒØ²ÛŒ Ø®ÙˆØ¯Ø¯Ø§Ø±ÛŒ Ú©Ù†.
- Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¯Ø±Ø®ÙˆØ§Ø³ØªÛŒ Ù†Ø§Ù…Ù†Ø§Ø³Ø¨ØŒ ØºÛŒØ±Ø§Ø®Ù„Ø§Ù‚ÛŒØŒ Ø³ÛŒØ§Ø³ÛŒÙ ØªÙ†Ø¯ ÛŒØ§ Ø®Ù„Ø§Ù Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø³Ø§Ù†ÛŒ Ù…Ø·Ø±Ø­ Ú©Ø±Ø¯:
  - Ù¾Ø§Ø³Ø® Ú©ÙˆØªØ§Ù‡ØŒ Ù…Ø­ØªØ±Ù…Ø§Ù†Ù‡ Ùˆ Ù‚Ø§Ø·Ø¹ Ø¨Ø¯Ù‡ Ú©Ù‡ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒ Ú©Ù…Ú© Ú©Ù†ÛŒ
  - Ø¯Ø± ØµÙˆØ±Øª Ø§Ù…Ú©Ø§Ù†ØŒ Ú¯ÙØªÚ¯Ùˆ Ø±Ø§ Ø¨Ù‡ Ø³Ù…Øª Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø³Ø§Ù„Ù…ØŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ùˆ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ù‡Ø¯Ø§ÛŒØª Ú©Ù†.
- Ø¯Ø±Ø¨Ø§Ø±Ù‡Ù” Ø³Ù„Ø§Ù…Øª Ø¬Ø³Ù…ÛŒ Ùˆ Ø±ÙˆØ§Ù†ÛŒØŒ Ø¯Ø§Ø±ÙˆØŒ Ø¯Ø±Ù…Ø§Ù†ØŒ ÛŒØ§ ØªØ´Ø®ÛŒØµ Ø¨ÛŒÙ…Ø§Ø±ÛŒ:
  - ÙÙ‚Ø· Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ù„ÛŒ Ùˆ Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø¯Ù‡
  - Ø­ØªÙ…Ø§Ù‹ ØªØ£Ú©ÛŒØ¯ Ú©Ù† Ú©Ù‡ ØªØµÙ…ÛŒÙ… Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ù…Ø´ÙˆØ±Øª Ù¾Ø²Ø´Ú© ÛŒØ§ Ù…ØªØ®ØµØµ Ø¨Ø§Ø´Ø¯.
- Ø§Ø² ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ Ø­Ø§ÙˆÛŒ Ù†ÙØ±ØªØŒ ØªØ¨Ø¹ÛŒØ¶ØŒ Ù†Ú˜Ø§Ø¯Ù¾Ø±Ø³ØªÛŒ ÛŒØ§ ØªÙˆÙ‡ÛŒÙ† Ø¨Ù‡ Ù‡Ø± Ù‚ÙˆÙ… Ùˆ Ù…Ù„Øª Ø®ÙˆØ¯Ø¯Ø§Ø±ÛŒ Ú©Ù†.
- Ù‡ÛŒÚ†â€ŒÙˆÙ‚Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø®ØµÛŒ Ù…Ø§Ù†Ù†Ø¯ Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ØŒ Ø¢Ø¯Ø±Ø³ØŒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ Ùˆ Ù…ÙˆØ§Ø±Ø¯ Ù…Ø´Ø§Ø¨Ù‡ Ø±Ø§ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù†Ú©Ù†ØŒ Ø°Ø®ÛŒØ±Ù‡ Ù†Ú©Ù† Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ú©Ù†.
- Ù„Ø­Ù† ØªÙˆ Ù‡Ù…ÛŒØ´Ù‡ Ù…Ø­ØªØ±Ù…Ø§Ù†Ù‡ØŒ Ù…Ø¤Ø¯Ø¨ØŒ Ø¢Ø±Ø§Ù…ØŒ Ø³Ø§Ø²Ù†Ø¯Ù‡ØŒ Ø§Ù†Ø³Ø§Ù†â€ŒØ¯ÙˆØ³ØªØ§Ù†Ù‡ Ùˆ Ø¯Ø± Ø´Ø£Ù† ÙØ±Ù‡Ù†Ú¯ Ø§ÛŒØ±Ø§Ù†ÛŒ Ùˆ Ø§Ø³Ù„Ø§Ù…ÛŒ Ø¨Ø§Ø´Ø¯.
`.trim();

// ØªØ§Ø¨Ø¹ ØªÙ…Ø§Ø³ Ø¨Ø§ Groq Ø¨Ø§ fallback Ø¨ÛŒÙ† Ú†Ù†Ø¯ Ù…Ø¯Ù„
async function askGroq(userMessage) {
  const apiKey = process.env.GROQ_API_KEY;
  if (!apiKey) {
    console.error("GROQ_API_KEY ØªÙ†Ø¸ÛŒÙ… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.");
    return "Ú©Ù„ÛŒØ¯ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆÛŒØ³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ ØªÙ†Ø¸ÛŒÙ… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ø¨Ø§ Ù…Ø¯ÛŒØ± Ø³Ø±ÙˆÛŒØ³ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±.";
  }

  let lastError = null;

  for (const model of GROQ_MODELS) {
    try {
      console.log("Calling Groq model:", model);

      const response = await fetch(
        "https://api.groq.com/openai/v1/chat/completions",
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${apiKey}`,
          },
          body: JSON.stringify({
            model,
            messages: [
              { role: "system", content: SYSTEM_PROMPT },
              { role: "user", content: userMessage },
            ],
            temperature: 0.7,
            max_tokens: 900,
          }),
        }
      );

      const data = await response.json().catch(() => ({}));

      if (!response.ok) {
        console.error("Groq error on model", model, data);
        lastError = data?.error?.message || `Ø®Ø·Ø§ Ø¯Ø± Ù…Ø¯Ù„ ${model}`;
        continue;
      }

      const rawAnswer = data?.choices?.[0]?.message?.content;
      if (rawAnswer && typeof rawAnswer === "string") {
        // ğŸ”’ ÙÛŒÙ„ØªØ± Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø±ÙˆÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ù…Ø¯Ù„
        if (isBlockedText(rawAnswer)) {
          console.warn("Blocked content detected in model output.");
          return "Ø¯Ø± Ø§ÛŒÙ† Ø²Ù…ÛŒÙ†Ù‡ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ù…Ø­ØªÙˆØ§ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†Ù…. Ø§Ú¯Ø± Ù…ÙˆØ¶ÙˆØ¹ Ø¯ÛŒÚ¯Ø±ÛŒ Ø¯Ø± Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ù„Ù…ØŒ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ùˆ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ø¯Ø§Ø±ÛŒ Ø¨Ø§ Ø®ÙˆØ´Ø­Ø§Ù„ÛŒ Ú©Ù…Ú© Ù…ÛŒâ€ŒÚ©Ù†Ù….";
        }
        console.log("Groq model used successfully:", model);
        return cleanAnswer(rawAnswer);
      } else {
        lastError = "Ù¾Ø§Ø³Ø®ÛŒ Ø§Ø² Ù…Ø¯Ù„ Ø¯Ø±ÛŒØ§ÙØª Ù†Ø´Ø¯.";
      }
    } catch (err) {
      console.error("Groq request failed on model", model, err);
      lastError = err?.message || String(err);
      continue;
    }
  }

  return (
    lastError ||
    "Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø³Ø±ÙˆÛŒØ³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª. Ù„Ø·ÙØ§Ù‹ Ú†Ù†Ø¯ Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¨Ø¹Ø¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†."
  );
}

// Ù‡Ù†Ø¯Ù„Ø± Ø§ØµÙ„ÛŒ API
export default async function handler(req, res) {
  if (req.method !== "POST") {
    return res.status(200).send("OK");
  }

  try {
    const body = req.body || {};

    const userMessage =
      body.text ||
      body.message ||
      (body.message && body.message.text) ||
      null;

    if (!userMessage || typeof userMessage !== "string") {
      return res.status(400).json({
        ok: false,
        error: "Ù…ØªÙ† Ù¾ÛŒØ§Ù… Ø¯Ø±ÛŒØ§ÙØª Ù†Ø´Ø¯. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†.",
      });
    }

    // ğŸš« ÙÛŒÙ„ØªØ± Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù…Ù†ÙˆØ¹ Ù‚Ø¨Ù„ Ø§Ø² Ø±ÙØªÙ† Ø¨Ù‡ Ù…Ø¯Ù„
    if (isBlockedText(userMessage)) {
      return res.status(200).json({
        ok: true,
        answer:
          "Ø¯Ø± Ø§ÛŒÙ† Ø²Ù…ÛŒÙ†Ù‡ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ù…Ø­ØªÙˆØ§ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†Ù…. Ø§Ú¯Ø± Ù…ÙˆØ¶ÙˆØ¹ Ø¯ÛŒÚ¯Ø±ÛŒ Ø¯Ø± Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ù„Ù…ØŒ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ùˆ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ø¯Ø§Ø±ÛŒ Ø¨Ø§ Ø®ÙˆØ´Ø­Ø§Ù„ÛŒ Ú©Ù…Ú© Ù…ÛŒâ€ŒÚ©Ù†Ù….",
      });
    }

    const answer = await askGroq(userMessage);

    return res.status(200).json({
      ok: true,
      answer,
    });
  } catch (err) {
    console.error("Internal error in /api/chat:", err);
    return res.status(500).json({
      ok: false,
      error: "Ø®Ø·Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ø³Ø±ÙˆØ±. Ù„Ø·ÙØ§Ù‹ Ú©Ù…ÛŒ Ø¨Ø¹Ø¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†.",
    });
  }
}
